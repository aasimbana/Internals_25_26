<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_status_template">
        <t t-call="web.external_layout">
            <main class="page">
                <div style="width:100%; margin: 30px 0 25px 0; display:flex; justify-content:space-between; align-items:center; font-size:14px;">
                    <div style="text-align:left; font-size:18px; font-weight:bold; color:#366092;">
                        Helpdesk Status Report
                    </div>
                    <div style="text-align:right; font-style:italic; color:#444; white-space:nowrap;">
                        <strong>Generated:</strong> <t t-esc="generated_at or 'N/A'"/>
                    </div>
                </div>

                <div style="margin-bottom: 20px; font-size:14px;">
                    <p><strong>Company:</strong> <t t-esc="company_name or ''"/></p>
                    <p><strong>End Date:</strong> <t t-esc="end_date or ''"/></p>
                </div>

                <table style="width:100%; border-collapse:collapse; border:1px solid #000; margin-bottom: 20px;">
                    <thead>
                        <tr style="background-color: #D9E1F2;">
                            <th style="border:1px solid #000; padding:8px; text-align:left;">Stage</th>
                            <t t-foreach="stage_types" t-as="stage_header">
                                <th style="border:1px solid #000; padding:8px; text-align:center;">
                                    <t t-esc="stage_header.upper()"/>
                                </th>
                            </t>
                            <th style="border:1px solid #000; padding:8px; text-align:center;">TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="rows" t-as="row">
                            <tr>
                                <td style="border:1px solid #000; padding:6px; background-color:#E6E6E6;">
                                    <t t-esc="row.get('stage')"/>
                                </td>
                                <t t-foreach="stage_types" t-as="stage_col">
                                    <td style="border:1px solid #000; padding:6px; text-align:center;">
                                        <t t-esc="row.get('counts', {}).get(stage_col, 0)"/>
                                    </td>
                                </t>
                                <td style="border:1px solid #000; padding:6px; text-align:center; font-weight:bold;">
                                    <t t-esc="row.get('total', 0)"/>
                                </td>
                            </tr>
                        </t>

                        <tr style="background-color: #F2F2F2;">
                            <td style="border:1px solid #000; padding:8px; text-align:right; font-weight:bold;">TOTAL</td>
                            <t t-foreach="stage_types" t-as="stage_col">
                                <td style="border:1px solid #000; padding:8px; text-align:center; font-weight:bold;">
                                    <t t-esc="totals.get(stage_col, 0)"/>
                                </td>
                            </t>
                            <td style="border:1px solid #000; padding:8px; text-align:center; font-weight:bold;">
                                <t t-esc="grand_total or 0"/>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div style="text-align: center; margin-top: 30px; font-style: italic; color: #666;">
                    <strong>Generated on:</strong> <t t-esc="generated_at or ''"/>
                </div>
            </main>
        </t>
    </template>
</odoo>