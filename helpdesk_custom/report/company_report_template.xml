<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="company_report_template">
        <t t-call="web.external_layout">
            <t t-set="d" t-value="data or {}"/>

           

            <main class="page">
                <div style="width:100%; margin: 10px 0 10px 0; display:flex; justify-content:space-between; align-items:center; font-size:10px;">
                    <div style="text-align:left; font-size:18px; font-weight:bold; color:#366092;">
                        Report by Company
                    </div>
                    <div style="text-align:right; font-style:italic; color:#444; white-space:nowrap;">
                        <strong>Period:</strong> 
                        from <t t-esc="d.get('start_date', 'N/A')"/> 
                        to <t t-esc="d.get('end_date', 'N/A')"/>
                    </div>
                </div>
                

                <table style="width:100%; border-collapse:collapse; border:1px solid #366092; margin-bottom:15px; table-layout:fixed;">
                    <thead>
                        <tr style="background-color: #366092; color:white;">
                            <th style="border:1px solid #366092; padding:5px; text-align:left; width:30%;">
                                <strong>Company</strong>
                            </th>
                            <t t-foreach="d.get('stage_types', [])" t-as="stage">
                                <th style="border:1px solid #366092; padding:10px; text-align:center; word-wrap:break-word; white-space:normal; width:8%;">
                                    <t t-esc="stage"/>
                                </th>
                            </t>
                          
                            <th style="border:1px solid #366092; padding:15px; text-align:center; width:8%;">
                                <strong>Total</strong>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="d.get('companies', [])" t-as="comp">
                            <tr>
                                <td style="border:1px solid #366092; padding:8px; background-color:#E6E6E6; font-weight:bold;">
                                    <t t-esc="comp.get('name','')"/>
                                </td>
                                <t t-foreach="d.get('stage_types', [])" t-as="stage">
                                    <td style="border:1px solid #366092; padding:11px; text-align:center;">
                                        <t t-esc="(comp.get('stage_counts') or {}).get(stage, 0)"/>
                                    </td>
                                </t>
                                <td style="border:1px solid #366092; padding:11px; text-align:center; background-color:#D9D9D9; font-weight:bold;">
                                    <t t-esc="comp.get('total', 0)"/>
                                </td>
                            </tr>
                        </t>
                
                        
                        <tr style="background-color:#BFBFBF; font-weight:bold;">
                            <td style="border:1px solid #366092; padding:11px; text-align:right;">
                                TOTAL
                            </td>
                            <t t-foreach="d.get('stage_types', [])" t-as="stage">
                                <td style="border:1px solid #366092; padding:11px; text-align:center;">
                                    <t t-esc="(d.get('overall_totals') or {}).get(stage, 0)"/>
                                </td>
                            </t>
                            <td style="border:1px solid #366092; padding:11px; text-align:center;">
                                <t t-esc="d.get('overall_total', 0)"/>
                            </td>
                        </tr>
                    </tbody>
                </table>
                
                
          
                <t t-if="not d.get('companies')">
                    <div style="text-align: center; padding: 20px; color: #666;">
                        <strong>No data found for the selected criteria</strong>
                    </div>
                </t>

            
                <div style="text-align: center; margin-top: 15px; font-style: italic; color:#666;">
                    <strong>Generated on:</strong> 
                    <t t-esc="d.get('generation_date', '')"/>
                </div>
            </main>
        </t>
    </template>
</odoo>
